<!DOCTYPE html>
<html lang="en"><head>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>Single Cell Data Preprocessing</title>
    <meta name="description" content="Genomics | Bioinformatics | Epigenetics">
    <meta name="keywords" content='blog, gokarna, hugo, data science, biology, genomics, bioinformatics, illumina-sequencing, sequencing library, single cell genomics, preprocessing'>

    <meta property="og:url" content="https://notarocketscientist.xyz/posts/2022-09-06-single-cell-data-preprocessing/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Single Cell Data Preprocessing">
    <meta property="og:description" content="Genomics | Bioinformatics | Epigenetics">
    <meta property="og:image" content="/images/profile_avatar.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Single Cell Data Preprocessing">
    <meta name="twitter:description" content="Genomics | Bioinformatics | Epigenetics">
    <meta property="twitter:domain" content="https://notarocketscientist.xyz/posts/2022-09-06-single-cell-data-preprocessing/">
    <meta property="twitter:url" content="https://notarocketscientist.xyz/posts/2022-09-06-single-cell-data-preprocessing/">
    <meta name="twitter:image" content="/images/profile_avatar.png">

    
    <link rel="canonical" href="https://notarocketscientist.xyz/posts/2022-09-06-single-cell-data-preprocessing/" />

    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="/css/dark.css">

    <script src="/js/svg-injector.min.js"></script>
    <script src="/js/feather-icons.min.js"></script>
    <script src="/js/main.js"></script>

    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css" integrity="sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js" integrity="sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ]
            });
        });
    </script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://notarocketscientist.xyz">
                <img src="https://notarocketscientist.xyz/images/profile_avatar.png" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://notarocketscientist.xyz">Not A Rocket Scientist</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://notarocketscientist.xyz/"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://notarocketscientist.xyz/about/"><span data-feather='user'></span> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://notarocketscientist.xyz/posts/"><span data-feather='list'></span> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://notarocketscientist.xyz/projects/"><span data-feather='square'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://notarocketscientist.xyz/tags/"><span data-feather='tag'></span> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/SUSTech-BIO210"><span data-feather='bar-chart-2'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/Teichlab/scg_lib_structs"><span data-feather='smile'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://notarocketscientist.xyz/"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://notarocketscientist.xyz/about/"><span data-feather='user'></span> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://notarocketscientist.xyz/posts/"><span data-feather='list'></span> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://notarocketscientist.xyz/projects/"><span data-feather='square'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://notarocketscientist.xyz/tags/"><span data-feather='tag'></span> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/SUSTech-BIO210"><span data-feather='bar-chart-2'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/Teichlab/scg_lib_structs"><span data-feather='smile'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Single Cell Data Preprocessing</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            September 6, 2022
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://notarocketscientist.xyz/tags/bioinformatics">bioinformatics</a></li>
        
            <li class="post-tag"><a href="https://notarocketscientist.xyz/tags/illumina-sequencing">illumina-sequencing</a></li>
        
            <li class="post-tag"><a href="https://notarocketscientist.xyz/tags/sequencing-library">sequencing library</a></li>
        
            <li class="post-tag"><a href="https://notarocketscientist.xyz/tags/single-cell-genomics">single cell genomics</a></li>
        
            <li class="post-tag"><a href="https://notarocketscientist.xyz/tags/preprocessing">preprocessing</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>When I started my PhD back in 2009, the next generation sequencing (NGS) technologies had already been out there for a while. They were in the process of being adapted by many labs. My impression back then was that it was difficult to learn how exactly those methods worked. There were many reasons for that, and one of them was the need of the commercial kits for the library preparation. As a beginner, you kind of knew roughly what the kit was doing: end repair, A tailing, ligate the adapters to the fragments <em>etc</em>. However, there were many missing details due to the black box nature of the kit. For example, what enzymes are used in each step? What are the oligo sequences? Are there any modifications on the oligos? Those things are critical to understand the method.</p>
<p>As more and more people started to use the NGS technology, many &hellip; probably too many (see <a href="https://www.nature.com/articles/nmeth.4558/"><strong>here</strong></a> and <a href="https://liorpachter.wordpress.com/seq/"><strong>here</strong></a>) &hellip; methods based on NGS were developed using off-the-shelf reagents. You started to read them and get increasingly more familiar with the NGS technology, especially the Illumina platforms since most methods were based on the Illumina machines. Then you realised: well &hellip; things become a bit clearer and it is not that difficult. All those different methods, commercial kits included, do only one thing: <strong>adding sequencing adapters to the DNA or cDNA fragments you are interested in</strong>. To make things even better, the <a href="https://support.illumina.com/downloads/illumina-adapter-sequences-document-1000000002694.html"><strong>adapter sequences are known</strong></a> now, even though they are considered as secrets.</p>
<p>However, when you actually looked at the protocols of those methods, you probably realised that it is still difficult to figure out how exactly the adapters are attached to the fragments in the desired orientation. The procedures are kind of complicated, especially for all those single cell methods. To help visualise what happens in each step, I created the <a href="https://github.com/Teichlab/scg_lib_structs"><strong>scg lib structs</strong></a> GitHub repository five years ago. One purpose of the repository is to help with the experimental troubleshooting, which I explained in <a href="/posts/2018-07-13-project-scg-lib-structs/"><strong>a previous post</strong></a>. There is another reason for the creation of the repository: to help with the data preprocessing.</p>
<p>In single cell genomics (and many other areas of genomics), when we talk about data analysis, there are actually two main steps. The first step is data preprocessing, a procedure that converts the raw data (<code>fastq</code> files) to some sort of count matrices, such as gene by cell or peak by cell matrices. The second step is data analysis, which cannot be developed into standard pipelines, because the data analysis step varies a lot depends on the purpose of the project. However, the first step can. In order to do that, we need to know the library structure and the read components of each method, which can be easily viewed in the <a href="https://github.com/Teichlab/scg_lib_structs"><strong>scg lib structs</strong></a> GitHub repository. In the early days of single cell genomics, one might have to combine and chain various tools and write custom scripts to preprocess data from different methods. This is very difficult and confusing for beginners and sometimes even for experienced bioinformaticians. In addition, it is difficult to compare different methods if different analysis pipelines are used to preprocess the data. With the fast development at the computational side of single cell genomics, it is now possible to actually just use <a href="https://www.biorxiv.org/content/10.1101/2021.05.05.442755v1"><strong>STARsolo</strong></a> and <a href="https://www.nature.com/articles/s41467-021-26865-w"><strong>chromap</strong></a> for most scRNA-seq and scATAC-seq methods.</p>
<p>Since I like <a href="https://readthedocs.org">ReadTheDocs</a> and want to learn how to use it, I created one to document how to use <code>STARsolo</code> for scRNA-seq and <code>chromap + MACS</code> for scATAC-seq data preprocessing. I focused a lot on &ldquo;what you should do if you have done the experiment by yourself using a specific method&rdquo;. It was a fun practice.</p>
<p><a href="https://scg-lib-structs.readthedocs.io/en/latest/"><strong>Click here</strong></a> to look at the preprocessing pipelines for many scRNA-seq and scATAC-seq methods.</p>

        </p>
    </div>

    <div class="prev-next">
        
    </div>
</div>



    

        </main><footer class="footer">
    <span>&copy; 2025 Not A Rocket Scientist</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
