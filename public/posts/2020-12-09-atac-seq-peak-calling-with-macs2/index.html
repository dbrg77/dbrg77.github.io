<!DOCTYPE html>
<html lang="en"><head>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>ATAC-seq Peak Calling With MACS2</title>
    <meta name="description" content="Genomics | Bioinformatics | Epigenetics">
    <meta name="keywords" content='blog, gokarna, hugo, data science, biology, genomics, bioinformatics, atac-seq, peak calling, macs2'>

    <meta property="og:url" content="https://dbrg77.github.io/posts/2020-12-09-atac-seq-peak-calling-with-macs2/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ATAC-seq Peak Calling With MACS2">
    <meta property="og:description" content="Genomics | Bioinformatics | Epigenetics">
    <meta property="og:image" content="/images/profile_avatar.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ATAC-seq Peak Calling With MACS2">
    <meta name="twitter:description" content="Genomics | Bioinformatics | Epigenetics">
    <meta property="twitter:domain" content="https://dbrg77.github.io/posts/2020-12-09-atac-seq-peak-calling-with-macs2/">
    <meta property="twitter:url" content="https://dbrg77.github.io/posts/2020-12-09-atac-seq-peak-calling-with-macs2/">
    <meta name="twitter:image" content="/images/profile_avatar.png">

    
    <link rel="canonical" href="https://dbrg77.github.io/posts/2020-12-09-atac-seq-peak-calling-with-macs2/" />

    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="/css/dark.css">

    <script src="/js/svg-injector.min.js"></script>
    <script src="/js/feather-icons.min.js"></script>
    <script src="/js/main.js"></script>

    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css" integrity="sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js" integrity="sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ]
            });
        });
    </script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://dbrg77.github.io">
                <img src="https://dbrg77.github.io/images/profile_avatar.png" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://dbrg77.github.io">Not A Rocket Scientist</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/about/"><span data-feather='user'></span> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/posts/"><span data-feather='list'></span> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/projects/"><span data-feather='square'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/tags/"><span data-feather='tag'></span> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://dbrg77.github.io/SUSTech-BIO210"><span data-feather='bar-chart-2'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/Teichlab/scg_lib_structs"><span data-feather='smile'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/about/"><span data-feather='user'></span> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/posts/"><span data-feather='list'></span> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/projects/"><span data-feather='square'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/tags/"><span data-feather='tag'></span> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://dbrg77.github.io/SUSTech-BIO210"><span data-feather='bar-chart-2'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/Teichlab/scg_lib_structs"><span data-feather='smile'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>ATAC-seq Peak Calling With MACS2</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            December 9, 2020
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://dbrg77.github.io/tags/bioinformatics">bioinformatics</a></li>
        
            <li class="post-tag"><a href="https://dbrg77.github.io/tags/genomics">genomics</a></li>
        
            <li class="post-tag"><a href="https://dbrg77.github.io/tags/atac-seq">atac-seq</a></li>
        
            <li class="post-tag"><a href="https://dbrg77.github.io/tags/peak-calling">peak calling</a></li>
        
            <li class="post-tag"><a href="https://dbrg77.github.io/tags/macs2">macs2</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>Although <strong><a href="http://www.nature.com/nmeth/journal/v10/n12/full/nmeth.2688.html">ATAC-seq</a></strong> has been extensively used in the functional genomics field to study chromatin accessibility, it is still under debate how we should perform peak calling to identify oepn chromatin regions. <a href="https://github.com/macs3-project/MACS">MACS2</a> is a very popular peak caller for ChIP-seq, and it has been used for ATAC-seq as well. How should we perform ATAC-seq peak calling using MACS2? That is a recurring question. If you pay attention to the details in those publications that uses ATAC-seq, you might notice that some people uses the <code>--shift -100 --extsize 200</code> flags during MACS2 peak calling.</p>
<p>For us, we routinely convert paired <code>BAM</code> to simple <code>BED</code> file and use the following flags with MACS2 to call ATAC-seq peaks:</p>
<pre tabindex="0"><code>-f BED --keep-dup all --nomodel --shift -100 --extsize 200
</code></pre><p>Why? Here are the reasons:</p>
<p>People tend to remove duplicates using the <a href="https://broadinstitute.github.io/picard/">Picard</a> tools after read alignment. By default, MACS2 will also remove duplicates in the data. If you use Picard, <code>--keep-dup all</code> will tell MACS2 not to perform duplicate removal. If you don&rsquo;t use Picard, you can remove that option and let MACS2 do the work. The point here is NOT to perform the same step twice with possibly different standards, <em>i.e.</em> Picard vs MACS2.</p>
<p>Like many other peak callers, MACS2 is designed for ChIP-seq. In ChIP-seq, the reads are flanking the actual binding site of the protein. Therefore, many peak callers either shift or extend reads towards the middle of the fragments to reflect the actual binding site. MACS2 uses extension, that is, the <code>--ext</code> flag.</p>
<p><img src="/images/2020-12-09/chip-seq.png" alt=""></p>
<p>In ATAC-seq/DNase-seq, the middle of the fragments is not really what we are interested in. Instead, we are interested in the blue and red dots in the figure shown below which are the cutting sites of the enzyme. Those dots are the start (5&rsquo; end) of your reads, so the default of MACS2 doesn&rsquo;t fit here.</p>
<p><img src="/images/2020-12-09/atac-seq.png" alt=""></p>
<p>Instead, we want to call peaks with fragments centred on the 5&rsquo; end of your reads. We had this discussion about 6 years ago in the MACS2 google usergroup. Both <a href="https://twitter.com/fooliu">@fooliu</a> and <a href="https://twitter.com/anshulkundaje">@anshulkundaje</a> provided excellent information. Check <a href="https://groups.google.com/g/macs-announcement/c/4OCE59gkpKY/m/v9Tnh9jWriUJ">this link</a> if haven&rsquo;t seen it before.</p>
<p>An update of MACS2 (ver 2.1.0 20140616) was made after the discussion, and you could freely manipulate the read positions with the combination of the <code>--shift</code> and the <code>--extsize</code> flags. Of course, when you do that, you need to add the <code>--nomodel</code> flag as well to ask MACS2 not to determine the shift size automatically. Then, why do we covert paired BAM to simple BED to use <code>-f BED</code>?</p>
<p>According to <a href="https://github.com/macs3-project/MACS/issues/145">Issue #145</a> from the MACS2 GitHub, when you set <code>-f BAM</code> or <code>-f BAMPE</code>, MACS2 only takes the left read, ignoring the other. However, in ATAC-seq the 5&rsquo; ends of both R1 and R2 are of interest. Convert to BED will solve this problem, I guess?</p>
<p>Finally, why <code>--shift -100 --extsize 200</code>? Well &hellip; this is arbituary and it is a habbit from ChIP-seq. To be honest, according to a <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2596141/">MNase-seq</a> study (check their Figure 1), it seems that using a fragment size of 75 bp centered on the cutting site might give better resolution. Maybe this chioce is better. In that case, it should be <code>--shift -37 --extsize 75</code>. The <a href="https://www.encodeproject.org">ENCODE</a> project used these parameters.</p>
<p>Not sure if all those modifications will make huge difference, but the results are different. I haven&rsquo;t tried other choices like HMMRATAC, Genrich, MACS3 <em>etc.</em> yet. I will probably do that in future. Hope this helps to those who are new to this type of analysis.</p>
<p>You can also find the Twitter discussion from <a href="https://twitter.com/XiChenUoM/status/1336658454866325506">this thread</a>.</p>

        </p>
    </div>

    <div class="prev-next">
        
    </div>
</div>



    

        </main><footer class="footer">
    <span>&copy; 2025 Not A Rocket Scientist</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
