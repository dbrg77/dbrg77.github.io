<!doctype html><html lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>3D Visualisation of The Residual Sum of Squares</title><meta name=description content="Genomics | Bioinformatics | Epigenetics"><meta name=keywords content='blog,gokarna,hugo,data science,biology,genomics,statistics,math,latex,python,teaching'><meta property="og:url" content="http://localhost:1313/posts/2023-07-10-3d-visualisation-of-the-residual-sum-of-squares/"><meta property="og:type" content="website"><meta property="og:title" content="3D Visualisation of The Residual Sum of Squares"><meta property="og:description" content="Genomics | Bioinformatics | Epigenetics"><meta property="og:image" content="/images/profile_avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="3D Visualisation of The Residual Sum of Squares"><meta name=twitter:description content="Genomics | Bioinformatics | Epigenetics"><meta property="twitter:domain" content="http://localhost:1313/posts/2023-07-10-3d-visualisation-of-the-residual-sum-of-squares/"><meta property="twitter:url" content="http://localhost:1313/posts/2023-07-10-3d-visualisation-of-the-residual-sum-of-squares/"><meta name=twitter:image content="/images/profile_avatar.png"><link rel=canonical href=http://localhost:1313/posts/2023-07-10-3d-visualisation-of-the-residual-sum-of-squares/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=/css/main.css><link disabled id=dark-theme rel=stylesheet href=/css/dark.css><script src=/js/svg-injector.min.js></script><script src=/js/feather-icons.min.js></script><script src=/js/main.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css integrity=sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js integrity=sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=http://localhost:1313/><img src=http://localhost:1313//images/profile_avatar.png alt=avatar></a></div><div class=nav-title><a class=nav-brand href=http://localhost:1313/>Not A Rocket Scientist</a></div><div class=nav-links><div class=nav-link><a href=http://localhost:1313/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=http://localhost:1313/about/><span data-feather=user></span> About</a></div><div class=nav-link><a href=http://localhost:1313/posts/><span data-feather=list></span> Posts</a></div><div class=nav-link><a href=http://localhost:1313/projects/><span data-feather=square></span> Projects</a></div><div class=nav-link><a href=http://localhost:1313/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://dbrg77.github.io/SUSTech-BIO210><span data-feather=bar-chart-2></span></a></div><div class=nav-link><a href=https://github.com/Teichlab/scg_lib_structs><span data-feather=smile></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=http://localhost:1313/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=http://localhost:1313/about/><span data-feather=user></span> About</a></li><li class=nav-item><a href=http://localhost:1313/posts/><span data-feather=list></span> Posts</a></li><li class=nav-item><a href=http://localhost:1313/projects/><span data-feather=square></span> Projects</a></li><li class=nav-item><a href=http://localhost:1313/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://dbrg77.github.io/SUSTech-BIO210><span data-feather=bar-chart-2></span></a></li><li class=nav-item><a href=https://github.com/Teichlab/scg_lib_structs><span data-feather=smile></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>3D Visualisation of The Residual Sum of Squares</h1><small role=doc-subtitle></small><p class=post-date>July 10, 2023</p><ul class=post-tags><li class=post-tag><a href=http://localhost:1313/tags/statistics>statistics</a></li><li class=post-tag><a href=http://localhost:1313/tags/math>math</a></li><li class=post-tag><a href=http://localhost:1313/tags/latex>latex</a></li><li class=post-tag><a href=http://localhost:1313/tags/python>python</a></li><li class=post-tag><a href=http://localhost:1313/tags/teaching>teaching</a></li></ul></div><div class=post-content><p><p>I recently came across the video <a href=https://youtu.be/my3lsV-VQjs>The Beauty of Linear Regression (How to Fit a Line to your Data)</a> by <a href=https://www.youtube.com/@RichBehiel>Richard Behiel</a>. The video is very inspiring! It illustrates the relationship between the residual sum of squares and the slope and intercept. The visualisation is intuitive and beautiful. I want to do a similar and simpler thing in the lecture slides for a course.</p><p>In the video, the residual sum of squares was shown as a heatmap and the arrows were used to represent the negative gradients. Here I just want to use a Z-axis to represent the residual sum of squares, such that I have:</p><ul><li><strong>The X-axis:</strong> the slope</li><li><strong>The Y-axis:</strong> the intercept</li><li><strong>The Z-axis:</strong> the residual sum of squares</li></ul><p>In addition, I have to use <code>pgfplots</code> to make the visualisation to have a consistent look with other content of the slides. What would the plot eventually look like? Let&rsquo;s see.</p><p>First, we need to clearly define what we actually want when we fit a straight line on a bunch of data points. In this case, we are doing a <strong>simple linear regression</strong>, and the method we are using is <strong>ordinary least square</strong>, or <strong>OLS</strong>. In <strong>OLS</strong>, it is the sum of the squared distance between the actual data point and the point on the line that we care about. Let&rsquo;s denote this as $\text{SE}_{\text{line}}$, and</p><p><img src=/images/2023-07-10/best_fit_line.png alt></p><p>Basically, we are doing some computations in the following order:</p><ol><li>We generate some $(x_i,\ y_i)$ pairs with a linear relationship</li><li>We represent a line in the form: $y=ax+b$</li><li>We compute the $\text{SE}_{\text{line}}$:</li></ol><p>$$ \text{SE}_\text{line} = \sum_{i=1}^n [y_i - (ax_i+b)]^2 $$</p><ol start=4><li>We put the slope ($a$) as the X-axis, the intercept ($b$) as the Y-axis, and the $\text{SE}_{\text{line}}$ as the Z-axis. Plot their relationship. Note that $x_i$ and $y_i$ are the knowns, and $a$ and $b$ are the unknowns</li></ol><p>We can further manipulate the expression of $\text{SE}_{\text{line}}$ to make it a bit clearer. Bear in mind that $a$ and $b$ are the unknowns:</p><p>$$
\begin{aligned}
\text{SE}_\text{line} &= \sum_{i=1}^n [y_i - (ax_i+b)]^2\\[10pt]
&= \sum_{i=1}^{n}[,y_i^2-2y_i(ax_i+b)+(ax_i+b)^2,] \\[10pt]
&= \sum_{i=1}^{n}(y_i^2-2ax_iy_i-2by_i+a^2x_i^2+2abx_i+b^2) \\[10pt]
&= \sum_{i=1}^{n}y_i^2-2a\sum_{i=1}^{n}x_iy_i-2b\sum_{i=1}^{n}y_i+a^2\sum_{i=1}^{n}x_i^2+2ab\sum_{i=1}^{n}x_i+nb^2\\[10pt]
&= \sum_{i=1}^{n}y_i^2- \left(2\sum_{i=1}^{n}x_iy_i\right) \cdot a - \left(2\sum_{i=1}^{n}y_i\right) \cdot b + \left(\sum_{i=1}^{n}x_i^2\right) \cdot a^2 + \left(2\sum_{i=1}^{n}x_i\right) \cdot ab +nb^2
\end{aligned}
$$</p><p>Now let&rsquo;s get some data, say 25 data points. We do this in python:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>numpy</span> <span style=color:#c678dd>as</span> <span style=color:#e06c75>np</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>np</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>random</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>seed</span>(<span style=color:#d19a66>42</span>)
</span></span><span style=display:flex><span><span style=color:#e06c75>xs</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>np</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>random</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>normal</span>(<span style=color:#e06c75>size</span><span style=color:#56b6c2>=</span><span style=color:#d19a66>25</span>)
</span></span><span style=display:flex><span><span style=color:#e06c75>ys</span> <span style=color:#56b6c2>=</span> <span style=color:#d19a66>2</span><span style=color:#56b6c2>*</span><span style=color:#e06c75>xs</span> <span style=color:#56b6c2>+</span> <span style=color:#d19a66>1</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>np</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>random</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>normal</span>(<span style=color:#e06c75>size</span><span style=color:#56b6c2>=</span><span style=color:#d19a66>25</span>)
</span></span></code></pre></div><p>With <code>xs</code> and <code>ys</code> values, we can calculate the coefficients in the $\text{SE}_{\text{line}}$:</p><table><thead><tr><th style=text-align:center>Coefficient</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:center>$\sum_{i=1}^{n}y_i^2$</td><td style=text-align:left>$135.95$ (<code>sum(ys * ys)</code>)</td></tr><tr><td style=text-align:center>$2\sum_{i=1}^{n}x_iy_i$</td><td style=text-align:left>$96.60$ ( <code>2 * sum(xs * ys)</code> )</td></tr><tr><td style=text-align:center>$2\sum_{i=1}^{n}y_i$</td><td style=text-align:left>$19.28$ ( <code>2 * ys.sum()</code> )</td></tr><tr><td style=text-align:center>$\sum_{i=1}^{n}x_i^2$</td><td style=text-align:left>$22.63$ ( <code>sum(xs * xs)</code> )</td></tr><tr><td style=text-align:center>$2\sum_{i=1}^{n}x_i$</td><td style=text-align:left>$-8.18$ ( <code>2 * xs.sum()</code> )</td></tr><tr><td style=text-align:center>$n$</td><td style=text-align:left>$25$</td></tr></tbody></table><p>Now we have the function we want to plot:</p><p>$$
\text{SE}_\text{line} = 135.95 - 96.6a -19.28b + 22.63a^2 -8.18ab +25b^2
$$</p><p>In terms of the X-, Y- and Z-axes, we are plotting:</p><p>$$
z = 135.95 - 96.6x -19.28y + 22.63x^2 -8.18xy +25y^2
$$</p><p>Now we could plot the above function as a 3D mesh using <code>\addplot3</code> from <strong>pgfplots</strong>. After playing around with the <code>view{}{}</code> option and setting appropriate domains of <code>x</code> and <code>y</code>, we can get a beautiful plot:</p><p><img src=/images/2023-07-10/3d_parabola.png alt></p><p>By looking at the this plot, it is clear to us that in <strong>OLS</strong> the $(a,b)$ we are looking for is the lowest point of the 3-dimensional parabola. The code used to generate the above plot is shown below:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-latex data-lang=latex><span style=display:flex><span><span style=color:#c678dd>\documentclass</span><span style=color:#e5c07b>{</span>beamer<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>\usepackage</span><span style=color:#e5c07b>{</span>tikz<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>\usepackage</span><span style=color:#e5c07b>{</span>pgfplots<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>\begin</span><span style=color:#e5c07b>{</span>document<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>\begin</span><span style=color:#e5c07b>{</span>frame<span style=color:#e5c07b>}{</span>OLS<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>\footnotesize</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>\begin</span><span style=color:#e5c07b>{</span>tikzpicture<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>        <span style=color:#c678dd>\begin</span><span style=color:#e5c07b>{</span>axis<span style=color:#e5c07b>}</span>[view = <span style=color:#e5c07b>{</span>25<span style=color:#e5c07b>}{</span>25<span style=color:#e5c07b>}</span>,
</span></span><span style=display:flex><span>                        xmin=-22.5, xmax=24, ymin=-23, ymax=22,
</span></span><span style=display:flex><span>                        height=7cm, width=7cm,
</span></span><span style=display:flex><span>                        axis line style=<span style=color:#e5c07b>{</span>gray!50<span style=color:#e5c07b>}</span>,
</span></span><span style=display:flex><span>                        xtick=<span style=color:#c678dd>\empty</span>, ytick=<span style=color:#c678dd>\empty</span>, ztick=<span style=color:#c678dd>\empty</span>,
</span></span><span style=display:flex><span>                        xlabel=<span style=color:#e5c07b>{</span>Slope (<span style=color:#98c379>$</span><span style=color:#e5c07b>a</span><span style=color:#98c379>$</span>)<span style=color:#e5c07b>}</span>, ylabel=<span style=color:#e5c07b>{</span>Intercept (<span style=color:#98c379>$</span><span style=color:#e5c07b>b</span><span style=color:#98c379>$</span>)<span style=color:#e5c07b>}</span>, zlabel=<span style=color:#e5c07b>{</span><span style=color:#98c379>$</span><span style=color:#e06c75>\text</span><span style=color:#e5c07b>{SE}_{</span><span style=color:#e06c75>\text</span><span style=color:#e5c07b>{Line}}</span><span style=color:#98c379>$</span><span style=color:#e5c07b>}</span>,
</span></span><span style=display:flex><span>                        colormap/cool]
</span></span><span style=display:flex><span>            <span style=color:#c678dd>\addplot</span>3[mesh, samples=50, domain=-20:20, domain y=-22:21]
</span></span><span style=display:flex><span>                        <span style=color:#e5c07b>{</span>135.95 - 96.6*x -19.28*y + 22.63*x<span style=color:#e5c07b>^</span>2 -8.18*x*y +25*y<span style=color:#e5c07b>^</span>2<span style=color:#e5c07b>}</span>;
</span></span><span style=display:flex><span>            <span style=color:#c678dd>\addlegendentry</span><span style=color:#e5c07b>{</span><span style=color:#98c379>$</span><span style=color:#e06c75>\text</span><span style=color:#e5c07b>{SE}_{</span><span style=color:#e06c75>\text</span><span style=color:#e5c07b>{Line}}</span><span style=color:#98c379>$</span><span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>        <span style=color:#c678dd>\end</span><span style=color:#e5c07b>{</span>axis<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>\end</span><span style=color:#e5c07b>{</span>tikzpicture<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>\end</span><span style=color:#e5c07b>{</span>frame<span style=color:#e5c07b>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>\end</span><span style=color:#e5c07b>{</span>document<span style=color:#e5c07b>}</span>
</span></span></code></pre></div></p></div><div class=prev-next></div></div></main><footer class=footer><span>&copy; 2025 Not A Rocket Scientist</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>